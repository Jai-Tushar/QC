\section{Convergence analysis}\label{sec:CA} 

We start by collecting some mathematical tools which will be helpful in the forthcoming analysis. 

\begin{lemma}[Sobolev inequality]\label{lem:Sobolev.inequality} Given any $\delta > 0$,
    \begin{align}\label{eq:Sobolev.inequality}
        \norm{L^\infty(D)}{v} \lesssim h_D^{-1} \norm{L^2(D)}{v} + \seminorm{H^1(D)}{v} + h_D^{\delta} \seminorm{H^{1+\delta}(D)}{v} \quad \forall v \in H^{1+\delta}(D).
    \end{align}
\end{lemma}

\begin{lemma}[Bramble-Hilbert estimates]
    Under the mesh regularity Assumption \ref{meshreg_assum.1}, given any $\delta > 0$, there exists a positive constant independent of $h_D$ such that 
    $$\inf_{p \in \Poly_k(D)} \seminorm{H^1(D)}{\lambda - \psi} \lesssim h_D^{\min(\delta,k)} \seminorm{H^{1+\delta}(D)}{\lambda}, \quad \forall \lambda \in H^{1+\delta}(D).$$
\end{lemma}
% \begin{proof}
%     Using arguments detailed in \cite[Lemma 4.3.8]{Brenner.Scott:2008:MTFEM} and then using interpolation theory \cite[Chapter 14]{Brenner.Scott:2008:MTFEM} to extend to fractional order Sobolev spaces.
% \end{proof}
\begin{lemma}[Trace inequality]\label{lem:trace.inequality}
    Let $e$ be an edge of $D \subset \R^2$. Then, for all $v \in H^{1+\delta}(D)$ with given $\delta > 0$, we have
    $$h_D^{2 \delta} \seminorm{H^{1/2+\delta}(e)}{v}^2 \lesssim \seminorm{H^1(D)}{v}^2 + h_D^{2\delta} \seminorm{H^{1+\delta}(D)}{v}^2.$$
\end{lemma}

\begin{lemma}[$H^1$-projector stability and approximation]\label{lem:L2p.properites} Given $\delta > 0$,
    \begin{align}
        \seminorm{H^1(D)}{\Pi^1_{k,D} v} &\leq \seminorm{H^1(D)}{v} \quad \forall v \in H^1(D), \label{eq:stability.H1p} \\
        \seminorm{H^1(D)}{v - \Pi^1_{k,D} v} &\lesssim h_D^{\min(\delta,k)} \seminorm{H^{1+\delta}(D)}{v} \quad \forall v \in H^{1+\delta}(D). \label{eq:approxH1.H1p} 
        % \norm{L^2(D)}{v - \Pi^1_{k,D} v} &\lesssim h_D^{l+1} \seminorm{H^{l+1}(D)}{v} \quad \forall v \in H^{l+1}(D), \quad 0 \leq l \leq k. \label{eq:approxL2.H1p} \\
        % \seminorm{H^1(D)}{v - \Pi^1_{k,D} v} &\lesssim h_D^{l} \seminorm{H^{l+1}(D)}{v} \quad \forall v \in H^{l+1}(D), \quad 1 \leq l \leq k. \label{eq:approxH1.H1p}.
    \end{align}
\end{lemma}

\begin{lemma}[$L^2$-projector stability and approximation]\label{lem:H1p.properties}
    \begin{align}
       &\norm{L^2(D)}{\Pi^0_{k,D} v} \leq \norm{L^2(D)}{v} \quad \forall v \in L^2(D), \quad
        \norm{H^1(D)}{\Pi^0_{k,D} v} \leq \norm{H^1(D)}{v} \quad \forall v \in H^1(D), \label{eq:stability.L2p} \\
        &\norm{L^2(D)}{v - \Pi^0_{k,D} v} \lesssim h_D^{l+1} \seminorm{H^{l+1}(D)}{v} \quad \forall v \in H^{l+1}(D), \quad 0 \leq l \leq k, \label{eq:approxL2.L2p}
    \end{align}
\end{lemma}

Now we recall the virtual element interpolation operator, which takes any sufficiently smooth function and maps it to the virtual element space. For $s > 1$, the global interpolation operator $\Ih{}: H^s(\Omega) \rightarrow V_h$ is the global counterpart of the local interpolation operator $\ID{}: H^s(D) \rightarrow V_h(D)$ for all $D \in \Th$ such that for any $v \in H^s(D)$,
\begin{align}
    \ID{v(p)} &= v(p) \quad \forall p \in \mathcal{N}^{\partial D}, \label{eq:ID.boundary} \\
    \Pi^0_{k-2,D} \ID{v} &= \Pi^0_{k-2,D} v \label{eq:ID.internal}. 
\end{align}
Here $\mathcal{N}^{\partial D}$ is the set of boundary degrees of freedom associated with the local virtual element space. 
% From \eqref{eq:ID.internal}, it follows that for $k \geq 2$, the interpolation $\ID{v}$ preserves the mean value of $v$ on each element $D$, i.e., given $v \in H^s(D) \cap L_0^2(\Omega)$,
% \begin{align}\label{rem:ID.meanvalue}
%     \int_D \ID{v} = \int_D \Pi^0_{k-2,D} (\ID{v}) = \int_D \Pi^0_{k-2,D} v = \int_D v = 0.
% \end{align}
% However, for $k = 1$, $\ID{v}$ is completely determined by boundary degrees of freedom \eqref{eq:ID.boundary} and does not necessarily preserve the mean value of $v$ on $D$.
    

\begin{lemma}[Interpolation operator stability and approximation]\label{lem:ID.properties}
    Given $\delta > 0$, we have
    \begin{align}
        \seminorm{H^1(D)}{\ID{v}} &\lesssim \seminorm{H^1(D)}{v} + h_D^{\delta} \seminorm{H^{1+ \delta}(D)}{v}, \quad \forall v \in H^{1+\delta}(D) \label{eq:ID.stability} \\
        \seminorm{H^1(D)}{v - \ID v} + \seminorm{H^1(D)}{v - \Pi^1_{k,D} \ID v} &\lesssim h_D^{\min(\delta,k)} \seminorm{H^{1+\delta}(D)}{v}, \quad \forall v \in H^{1+\delta}(D)\label{eq:ID.approximation} \\
        \norm{L^2(D)}{v - \ID v} + \norm{L^2(D)}{v - \Pi^1_{k,D} \ID v} &\lesssim h_D^{{\min(\delta,k)}+1} \seminorm{H^{1+\delta}(D)}{v}, \quad \forall v \in H^{1+\delta}(D)\label{eq:ID.approximation.L2}
    \end{align}   
\end{lemma}

% We will also use the following inverse inequality for virtual element functions \cite[Lemma 2.19]{brenner.guan.ea:2017:some}.
% \begin{lemma}[Inverse inequality]\label{lem:inverse.inequality}
%     Under the mesh regularity assumptions \eqref{meshreg_assum.1}-\eqref{meshreg_assum.2} we have for all $v_h \in V_h(D)$,
%     \begin{align*}
%         \seminorm{H^1(D)}{v_h} \lesssim h_D^{-1} \tnorm{k,D}{v_h},
%     \end{align*}
%     where, $\tnorm{k,D}{\cdot}$ plays the role of $L^2$-norm and is defined as
%     $$\tnorm{k,D}{v_h}^2 = h_D \sum_{e \in \E_D} \norm{L^2(e)}{\Pi^0_{k,e} v_h}^2 + \norm{L^2(D)}{\Pi^0_{k-2,D} v_h}^2.$$
% \end{lemma}

In the subsequent analysis, we work with the following assumption which is made concrete in Remark \ref{coercivity.assum}.
\begin{assumption}\label{assum:coercivity}
    Let $\norm{h_\beta}{\cdot} = \sqrt{a_h(\cdot,\cdot) + \beta (\Pi^0_{k,h} \cdot, \Pi^0_{k,h} \cdot)}$ denote the mesh-dependent energy norm such that 
    \begin{align}
        \seminorm{H^1(\Omega)}{v_h} &\lesssim \norm{h_\beta}{v_h} \quad \forall v_h \in V_h^0, \label{eq:coercivity.Dirichlet} \\
        \seminorm{H^1(\Omega)}{v_h} &\lesssim \norm{h_\beta}{v_h} \quad \forall v_h \in V_h \quad \mbox{with} \quad (v_h,1) = 0. \label{eq:coercivity.Neumann} 
    \end{align}
\end{assumption}

We also define the piecewise-broken $H^1$-seminorm by
\begin{align*}
    \seminorm{1,h}{v} := \left( \sum_{D \in \Th} \seminorm{H^1(D)}{v}^2 \right)^{\frac{1}{2}} \quad \forall v \in H^1(\Th).
\end{align*}

Some useful estimates in the mesh-dependent norm and piecewise broken semi-norm are in order.
\begin{lemma}\label{lem:est.mesh.dependent}
    The following estimates hold,
    \begin{align}
        \norm{h_0}{\Ih{v} - \Pi^1_{k,h} \Ih{v}} + \seminorm{1,h}{\Ih{v} - \Pi^1_{k,h} \Ih{v}} &\lesssim h^{\min(\delta,k)} \seminorm{H^{1+\delta}(\Omega)}{v} \quad \forall v \in H^{1+\delta}(\Omega), \label{eq:est.Ih.h.norm} \\
        \norm{h_\beta}{v- \Ih{v}} + \norm{h_\beta}{v- \Pi^1_{k,h} v} &\lesssim h^{\min(\delta,k)} \seminorm{H^{1+\delta}(\Omega)}{v} \quad \forall v \in H^{1+\delta}(\Omega). \label{eq:est.hbeta.norm}
    \end{align}
\end{lemma}

\begin{remark}\label{coercivity.assum}
    \corr{}{}{[JT: To do - Making Assumption 5.7 concrete, for shape-regular meshes vs meshes with small edges]}
    
\end{remark}



\subsection{$\Omega$ is simply connected $(\gamma = 0)$} Our first aim is to estimate the error $\xi - \xi_h$. To this end, we first write down the error equation by testing \eqref{eq:P.rho} with $\psi_h \in V_h$ and subtracting it from \eqref{eq:Ph.rhoh},
\begin{align}\label{eq:erreq.rho}
    (\curl{\rho}, \curl{\psi_h}) - a_h(\rho_h,\psi_h) = (\bs{f}, \curl{(\psi_h - \Pi^1_{k,h}(\psi_h))}) \quad \forall \psi_h \in V_h.
\end{align}
We note that to obtain the above error equation we also used the definition of $\Pi^0_{k,h}$ and the fact that $\rho, \rho_h \in L_0^2(\Omega)$. Furthermore, in view of \eqref{eq:P.rho}, \eqref{eq:Ph.rhoh}, $\rho, \rho_h \in L_0^2(\Omega)$ and Assumption \ref{assum:coercivity}, we have the following relations:
\begin{align}\label{eq:curl.data}
    \norm{L^2(\Omega)}{\curl{\rho}} \leq \norm{L^2(\Omega)}{\bs{f}}, \quad \mbox{and} \quad \norm{L^2(\Omega)}{\curl{\rho_h}} \lesssim \norm{L^2(\Omega)}{\bs{f}}.
\end{align}

In the following lemma we estimate the error for $\rho_h$ in the dual norm using a duality argument.

\begin{lemma}\label{lem:rhoh.dual}
    For any $\epsilon > 0$, there exists a positive constant dependent on $\epsilon$ and independent of $h$ such that
    \begin{align}\label{eq:err.est.rho}
       | (\rho-\rho_h, \chi) | \lesssim h^{\min{((\pi / \omega) - \epsilon, k)}} \norm{H^1(\Omega)}{\chi} \norm{L^2(\Omega)}{\bs{f}} \quad \forall \chi \in H^1(\Omega).
    \end{align}

\end{lemma}

\begin{proof}
    Given arbitary $\chi \in H^1(\Omega)$, let $\lambda \in H^1(\Omega)$ solve the following dual problem:
\begin{align}\label{eq:dual.rho}
    (\curl{\psi}, \curl{\lambda}) + (\psi,1) (\lambda,1) = (\psi, \chi) \quad \forall \psi \in H^1(\Omega).
\end{align}
Testing \eqref{eq:dual.rho} with $\rho - \rho_h \in H^1(\Omega)$ and exploiting $\rho, \rho_h \in L_0^2(\Omega)$, we get
\begin{align}\label{eq:err.rho.1}
    (\rho - \rho_h,\chi) &= (\curl{(\rho - \rho_h)}, \curl{\lambda}) + (\rho - \rho_h,1) (\lambda,1) \nonumber\\
    &= (\curl{(\rho - \rho_h)}, \curl{(\lambda- \Ih{\lambda})} ) + (\curl{(\rho - \rho_h)}, \curl{\Ih{\lambda}}).
\end{align}
The first term in \eqref{eq:err.rho.1} is bounded using the Cauchy-Schwarz inequality and \eqref{eq:curl.data}, to get
\begin{align}\label{eq:err.rho.1.a}
    (\curl{(\rho - \rho_h)}, \curl{(\lambda- \Ih{\lambda})} ) &\leq \norm{L^2(\Omega)}{\curl{(\rho - \rho_h)}} \norm{L^2(\Omega)}{\curl{(\lambda - \Ih{\lambda})}}. \nonumber \\
    &\lesssim \norm{L^2(\Omega)}{\bs{f}} \seminorm{H^1(\Omega)}{\lambda - \Ih{\lambda}}.
\end{align}

The second term in \eqref{eq:err.rho.1} is bounded using the error equation \eqref{eq:erreq.rho} for $\psi_h = \Ih{\lambda}$ as follows:
\begin{align}\label{eq:err.rho.1.b}
    (\curl{(\rho - \rho_h)}, \curl{\Ih{\lambda}}) &= (\curl{\rho}, \curl{\Ih{\lambda}}) - (\curl{\rho_h}, \curl{\Ih{\lambda}}) \nonumber\\
    &= (\bs{f}, \curl{(\Ih{\lambda} - \Pi^1_{k,h} \Ih{\lambda})}) + a_h(\rho_h,\Ih{\lambda}) - (\curl{\rho_h}, \curl{\Ih{\lambda}}) \nonumber\\
    &\leq \norm{L^2(\Omega)}{\bs{f}} \seminorm{1,h}{(I-\Pi^1_{k,h})\Ih{\lambda}} + a_h(\rho_h,\Ih{\lambda}) - (\curl{\rho_h}, \curl{\Ih{\lambda}}).
\end{align}

The difference in \eqref{eq:err.rho.1.b} can be rewritten as follows:
\begin{align}
    &a_h(\rho_h,\Ih{\lambda}) - (\curl{\rho_h}, \curl{\Ih{\lambda}})  \nonumber\\
    &\quad=\sum_{D \in \Th} (\curl{\Pi^1_{k,D} \rho_h, \curl{\Pi^1_D {\ID{\lambda}}}}) + S^D((I - \Pi^1_{k,D})\rho_h, (I - \Pi^1_{k,D})\ID{\lambda}) -\nonumber\\
    &\qquad\qquad(\curl{\rho_h}, \curl{(\Ih{\lambda}-\Pi^1_{k,D}\ID{\lambda})}) - (\curl{\rho_h}, \curl{\Pi^1_{k,D}\ID{\lambda}}) \nonumber\\
    &\quad= \sum_{D \in \Th} S^D((I - \Pi^1_{k,D})\rho_h, (I - \Pi^1_{k,D})\ID{\lambda}) - (\curl{\rho_h}, \curl{(\ID{\lambda} - \Pi^1_{k,D}\ID{\lambda})}) \nonumber\\
    &\quad\leq  (\sum_{D \in \Th} S^D((I - \Pi^1_{k,D})\rho_h, (I - \Pi^1_{k,D})\rho_h))^{1/2} (\sum_{D \in \Th} S^D((I - \Pi^1_{k,D})\ID{\lambda}, (I - \Pi^1_{k,D})\ID{\lambda}))^{1/2} \nonumber\\
    &\qquad\qquad (\sum_{D \in \Th} \seminorm{H^1(D)}{\rho_h}^2)^{1/2} (\sum_{D \in \Th} \seminorm{H^1(D)}{\ID{\lambda} - \Pi^1_{k,D}\ID{\lambda}}^2)^{1/2} \nonumber\\
    &\quad\lesssim \norm{h_0}{(I - \Pi^1_{k,h})\rho_h} \norm{h_0}{(I-\Pi^1_{k,h})\Ih{\lambda}} + \seminorm{H^1(\Omega)}{\rho_h} \seminorm{1,h}{(I - \Pi^1_{k,h})\Ih{\lambda}}. \label{eq:err.rho.1.c}
\end{align}
Where in the passage to the second equality we used the definition of $\Pi^1_{k,D}$ projector followed by Cauchy-Schwarz inequality and finally the definition of $\norm{h}{\cdot}$ and $\seminorm{1,h}{\cdot}$. Using the linearity and idempotency of $\Pi^1_{k,D}$ and $\rho_h \in L_0^2(\Omega)$ we have that
\begin{align*}
    \norm{h_0}{(I - \Pi^1_{k,h} \rho_h)}^2 &= S((I - \Pi^1_{k,h})\rho_h, (I - \Pi^1_{k,h})\rho_h) \nonumber\\ 
    &\overset{\eqref{eq:Ph.rhoh}}{=} (\bs{f}, \curl{\Pi^1_{k,h} \rho_h}) - (\curl{\Pi^1_{k,h} \rho_h}, \curl{\Pi^1_{k,h} \rho_h}) \nonumber\\
    &\leq \sum_{D \in \Th} \norm{L^2(D)}{\bs{f}} \norm{H^1(D)}{\Pi^1_{k,D} \rho_h} + \norm{H^1(D)}{\Pi^1_{k,D} \rho_h}^2 \nonumber\\
    &\overset{\eqref{eq:stability.H1p}}{\leq}  \sum_{D \in \Th} \norm{L^2(D)}{\bs{f}} \norm{H^1(D)}{\rho_h} + \norm{H^1(D)}{\rho_h}^2 \overset{\eqref{eq:curl.data}}{\lesssim} \norm{L^2(\Omega)}{\bs{f}}^2.
\end{align*}
The regularity of the dual problem from Lemma \ref{lem:reg.pure-neumann}, the above bound, the estimate \eqref{eq:est.Ih.h.norm} with $\delta = (\pi/\omega)-\epsilon$, and \eqref{eq:curl.data} lead to the following bound on \eqref{eq:err.rho.1.c},
\begin{align*}
    a_h(\rho_h,\Ih{\lambda}) - (\curl{\rho_h}, \curl{\Ih{\lambda}}) \lesssim h^{\min{((\pi / \omega)-\epsilon,k)}} \norm{L^2(\Omega)}{\bs{f}} \seminorm{H^{1+(\pi/\omega)-\epsilon}(\Omega)}{\lambda}.  
\end{align*}

Substituting in \eqref{eq:err.rho.1.b}, again using \eqref{eq:est.Ih.h.norm} and the data dependence relation of the dual problem in Lemma \ref{lem:reg.pure-neumann} yield
\begin{align*}
    (\curl{(\rho - \rho_h)}, \curl{\Ih{\lambda}}) &\lesssim  h^{\min{((\pi / \omega)-\epsilon,k)}} \norm{L^2(\Omega)}{\bs{f}} \norm{H^{1}(\Omega)}{\chi}.
\end{align*}
Substituting the above bound and \eqref{eq:err.rho.1.a} into \eqref{eq:err.rho.1}, and using the definition of piecewise-broken $H^1$-seminorm and \eqref{eq:ID.approximation} yields the desired error estimate \eqref{eq:err.est.rho}.
\end{proof}


It remains to estimate the error for $\xi_h$. 
\begin{lemma}\label{lem:xi.est}
    For any $\epsilon > 0$, there exists a positive constant dependent on $\epsilon$ and independent of $h$ such that for $k = 1,2$,
    \begin{align}
        \seminorm{H^1(\Omega)}{\xi - \xi_h} &\lesssim h^{\min{((\pi / \omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}, \label{eq:err.est.xi} \\
         \seminorm{H^1(\Omega)}{\xi - \Pi^1_{k,h} \xi_h}&\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}. \label{eq:err.est.Proj_xi}
    \end{align}
\end{lemma}
\begin{proof}
    Given $\rho_h \in V_h \cap L_0^2(\Omega)$, let $\tilde{\xi}_0 \in H_0^1(\Omega)$ solve the following auxiliary problem,
    \begin{align}\label{eq:P.aux}
        (\curl{\tilde{\xi}_0}, \curl{\eta}) + \beta(\tilde{\xi}_0, \eta) = (\rho_h, \eta) \quad \forall \eta \in H_0^1(\Omega).
    \end{align}
    Since $\rho_h \in V_h \subset H^1(\Omega)$, due to Lemma \ref{lem:reg.reac-diff}, 
    \begin{align}\label{tildexi0.reg}
        \tilde \xi_0 \in H^{1+(\pi/\omega)-\epsilon}(\Omega) \quad \mbox{and} \quad \norm{H^{1+(\pi/\omega)-\epsilon}(\Omega)}{\tilde \xi_0} \lesssim \norm{H^1(\Omega)}{\rho_h}.
    \end{align}
    It follows now from \eqref{eq:P.xi0}, \eqref{eq:P.aux}, and the duality estimate \eqref{eq:err.est.rho} that
    \begin{align}\label{eq:xi0.a}
        \seminorm{H^1(\Omega)}{\xi_0 - \tilde{\xi}_0} &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}.
    \end{align}

It follows from \eqref{eq:P.aux} and \eqref{eq:Ph.xi0h} that $\xi_{0,h}$ is also a virtual element approximation of $\tilde \xi_0$ and hence we have the following analogous abstract error estimate following \cite[Section 4.3]{Brenner-Sung-2018-VEM-Small-Edges-Faces},
\begin{align}\label{err.abs.xi0h}
    \norm{h_{\beta}}{\tilde \xi_0 - \xi_{0,h}} &\lesssim \norm{h_\beta}{\tilde \xi_0 - \Ih{\tilde \xi_0}} + \seminorm{1,h}{\tilde \xi_0 - \Pi^1_{k,h} \tilde \xi_0} + \norm{h_\beta}{\tilde \xi_0 - \Pi^1_{k,h} \tilde \xi_0} \nonumber\\
    &\qquad + \beta h \norm{L^2(\Omega)}{\tilde \xi_0 - \Pi^0_{k,h} \tilde \xi_0} + \sup_{w_h \in V_h^0 \backslash \{0\}} \frac{(\rho_h, w_h - \Pi^0_{k,h} w_h)}{\seminorm{H^1(\Omega)}{w_h}}.
\end{align}

The numerator in the last term of \eqref{err.abs.xi0h} is estimated using the definition of $\Pi^0_{k,h}$, the fact that it minimizes it's respective norm, the fact $\rho_h, w_h \in V_h \subset H^1(\Omega)$ and the approximation property of $\Pi^0_{k,h}$ follows:
\begin{align}
    (\rho_h, w_h - \Pi^0_{k,h} w_h) &= (\rho_h - \Pi^0_{0,h} \rho_h, w_h - \Pi^0_{k,h} w_h) \nonumber\\
    &\leq \norm{L^2(\Omega)}{\rho_h - \Pi^0_{0,h} \rho_h} \norm{L^2(\Omega)}{w_h - \Pi^0_{0,h} w_h} \nonumber\\
    &\lesssim h^2 \seminorm{H^1(\Omega)}{\rho_h} \seminorm{H^1(\Omega)}{w_h}. \label{eq:err.abs.xi0h.source}
\end{align}

Using the approximation properties stated in \eqref{eq:est.hbeta.norm}, the definition of $\seminorm{1,h}{\cdot}$, the estimates \eqref{eq:approxH1.H1p} and \eqref{eq:approxL2.L2p} for $\delta = (\pi/\omega) - \epsilon$, and \eqref{eq:err.abs.xi0h.source}, we can get the following concrete bound on \eqref{err.abs.xi0h}.
\begin{align*}
    \norm{h_{\beta}}{\tilde \xi_0 - \xi_{0,h}} &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} (\seminorm{H^{1 + (\pi/\omega) - \epsilon}(\Omega)}{\tilde \xi_0} + \seminorm{H^1(\Omega)}{\rho_h}) \nonumber\\
    &\hspace{-0.65cm}\overset{\eqref{tildexi0.reg},\eqref{eq:curl.data}}{\lesssim} h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}.
\end{align*}
Now, using Assumption \ref{assum:coercivity} in the above estimate yields
\begin{align}\label{eq:xi0h.b}
    \seminorm{H^1(\Omega)}{\tilde \xi_0 - \xi_{0,h}} \lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}.
\end{align}
Finally, a triangle inequality alongwith \eqref{eq:xi0.a} and \eqref{eq:xi0h.b} leads to \eqref{eq:err.xi0}
\begin{align}\label{eq:err.xi0}
     \seminorm{H^1(\Omega)}{\xi_0 - \xi_{0,h}} \lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}.
\end{align}
Similarly, we can get the following control on $\xi_1 - \xi_{1,h}$ (see \eqref{eq:P.xi1} and \eqref{eq:Ph.xi1h})
\begin{align}\label{eq:err.xi1}
     \seminorm{H^1(\Omega)}{\xi_1 - \xi_{1,h}} \lesssim h^{\min{((\pi/\omega) - \epsilon, k)}}.
\end{align}
The estimate \eqref{eq:err.est.xi} now follows from \eqref{eq:err.xi0}, \eqref{eq:err.xi1}, \eqref{eq:P.xi}, and \eqref{eq:Ph.xih}. Since, $\xi \in H^{1+(\pi/\omega) - \epsilon}(\Omega)$ we can get the estimate \eqref{eq:err.est.Proj_xi} using Lemma \ref{lem:H1p.properties} and \eqref{eq:err.est.xi}  as follows,
\begin{align*}
    \seminorm{1,h}{\xi - \Pi^1_{k,h} \xi_h} &\leq \seminorm{1,h}{\xi - \Pi^1_{k,h} \xi} + \seminorm{1,h}{\Pi^1_{k,h} (\xi - \xi_h)} \nonumber\\
    &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{H^{1+(\pi/\omega) - \epsilon}(\Omega)}{\xi} + \seminorm{H^1(\Omega)}{\xi - \xi_h} \nonumber\\
    &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}.
\end{align*}
In the last step we used Lemma \ref{lem:reg.reac-diff} on \eqref{eq:xi} followed by \eqref{eq:curl.data}. This completes the proof.
\end{proof}

The error analysis for $\phi_h$ is analogous to that of $\xi_h$.

\begin{lemma}\label{lem:est.phi}
    For any $\epsilon > 0$, there esists a positive constant dependent on $\epsilon$ and independent of $h$ such that for $k = 1,2$,
    \begin{align}
        \seminorm{H^1(\Omega)}{\phi - \phi_h} &\lesssim h^{\min{((\pi / \omega) - \epsilon, k)}} \left(\norm{H^1(\Omega)}{\xi_h} + \norm{L^2(\Omega)}{\bs{f}}\right), \label{eq:err.est.phi} \\
        \seminorm{1,h}{\phi - \Pi^1_{k,h} \phi_h} &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \left( \norm{H^1(\Omega)}{\xi} + \norm{H^1(\Omega)}{\xi_h} +\norm{L^2(\Omega)}{\bs{f}}\right). \label{eq:err.est.Proj_phi}
    \end{align}
\end{lemma}
\begin{proof}
    Given $\xi_h \in V_h \cap L_0^2(\Omega)$, let $\tilde{\phi} \in H^1(\Omega)$ solve the following auxiliary problem,
    \begin{align}\label{eq:P.aux.phi}
        (\curl{\tilde \phi}, \curl{\psi}) + (\tilde \phi, 1) (\tilde \psi, 1) = (\xi_h, \psi) \quad \forall \psi \in H^1(\Omega).
    \end{align}
    Since $\xi_h \in V_h \subset H^1(\Omega)$, due to Lemma \ref{lem:reg.pure-neumann}, 
    \begin{align}\label{tildephi.reg}
        \tilde \phi \in H^{1+(\pi/\omega)-\epsilon}(\Omega) \quad \mbox{and} \quad \norm{H^{1+(\pi/\omega)-\epsilon}(\Omega)}{\tilde \phi} \lesssim \norm{H^1(\Omega)}{\xi_h}.
    \end{align}
    Comparing \eqref{eq:P.phi} and \eqref{eq:P.aux.phi}, using a standard Poincar\'e inequality for $\xi - \xi_h \in H_0^1(\Omega)$ alongwith \eqref{eq:err.est.xi} gives,
    \begin{align}\label{eq:phi.a}
        \seminorm{H^1(\Omega)}{\phi - \tilde{\phi}} \lesssim \norm{L^2(\Omega)}{\xi - \xi_h} \lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{L^2(\Omega)}{\bs{f}}.
    \end{align}

    It follows from \eqref{eq:P.aux.phi} and \eqref{eq:Ph.phih} that $\phi_h$ is also a virtual element approximation of $\tilde \phi$ and hence using the fact the $\rho, \rho_h \in L_0^2(\Omega)$ we have the following analogous abstract error estimate following \cite[Section 4.3]{Brenner-Sung-2018-VEM-Small-Edges-Faces},
    \begin{align*}
        \norm{h_{\beta}}{\tilde \phi - \phi_h} &\lesssim \norm{h_0}{\tilde \phi - \Ih{\tilde \phi}} + \seminorm{1,h}{\tilde \phi - \Pi^1_{k,h} \tilde \phi} + \norm{h_0}{\tilde \phi - \Pi^1_{k,h} \tilde \phi} + \sup_{w_h \in V_h^0 \backslash \{0\}} \frac{(\xi_h, w_h - \Pi^0_{k,h} w_h)}{\seminorm{H^1(\Omega)}{w_h}}.
    \end{align*}
    Following similar arguments as in the proof of Lemma \ref{lem:xi.est} and \eqref{tildephi.reg}, we can get the following concrete bound,
    \begin{align}\label{eq:phi.b}
        \seminorm{H^1(\Omega)}{\tilde \phi - \phi_h} &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} (\norm{H^{1 + (\pi/\omega) - \epsilon}(\Omega)}{\tilde \phi} + \seminorm{H^1(\Omega)}{\xi_h}) \nonumber\\
        &\lesssim h^{\min{((\pi/\omega) - \epsilon, k)}} \norm{H^1(\Omega)}{\xi_h}.
    \end{align}
    Combining \eqref{eq:phi.a} and \eqref{eq:phi.b} using a triangle inequality leads to \eqref{eq:err.est.phi}. 

    Moreover, it follows from \eqref{eq:P.phi} and Lemma \ref{lem:reg.pure-neumann} that 
    \begin{align}\label{eq:reg.phi}
        \phi \in H^{1+(\pi/\omega) - \epsilon}(\Omega) \quad \mbox{and} \quad \norm{H^{1+(\pi/\omega) - \epsilon}(\Omega)}{\phi} \lesssim \norm{H^1(\Omega)}{\xi}.    
    \end{align}
    Hence, using similar arguments as in the proof of \eqref{eq:err.est.Proj_xi} with \eqref{eq:reg.phi} leads to \eqref{eq:err.est.Proj_phi}.
\end{proof}

In view of Lemmas \ref{lem:xi.est}, \ref{lem:est.phi}, \eqref{u.simplyConnected} and \eqref{uh.simplyConnected}, we readily have the following result for simply connected domains.
\begin{theorem}\label{thm:simplyconnected}
    The approximations $\xi_h$ and $\bs{u}_h$ obtained by $\Poly_k$-virtual finite element method satisfy 
    \begin{align}\label{eq:err.est.simplyconnected}
        \norm{L^2(\Omega)}{\bs{u} - \bs{u}_h} + \seminorm{H^1(\Omega)}{\curl{\bs{u}} - \xi_h} \lesssim h^{\min{((\pi / \omega) - \epsilon, k)}} \left( \norm{H^1(\Omega)}{\xi} + \norm{H^1(\Omega)}{\xi_h} +\norm{L^2(\Omega)}{\bs{f}}\right).
    \end{align}
    for any $\epsilon > 0$, and $k = 1,2$, where $\omega$ is the largest angle at the corners of $\Omega$.
\end{theorem} 
\begin{proof}
    The estimate for $\bs{u} - \bs{u}_h$ follows from \eqref{eq:err.est.Proj_phi} on observing the following,
    $$\norm{L^2(\Omega)}{\bs{u} - \bs{u}_h} = \norm{L^2(\Omega)}{\curl{\phi} - \curl{\Pi^1_{k,h} \phi_h}}=\seminorm{1,h}{\phi - \Pi^1_{k,h} \phi_h}.$$
    Recalling that $\xi = \curl{\bs{u}}$, the estimate for $\curl{\bs{u}} - \xi_h$ follows from \eqref{eq:err.est.xi}.
\end{proof}


\subsection{$\Omega$ is multiply connected $(\gamma > 0)$}
The convergence analysis for the multiply connected case follows ideas similar to those in the simply connected case extended to the coupled setting. We first write down the error equation for $(\zeta_{0,h}, \xi_{0,h})$ by testing \eqref{eq:P.zeta0.xi0} with $(\psi_h, \eta_h) \in V_h \times V_h^0$, subtracting it from \eqref{eq:Ph.zeta0.xi0} and using $\zeta_0, \zeta_{0,h} \in L_0^2(\Omega)$,
\begin{align}\label{eq:err.zeta0.xi0}
    \A((\zeta_0,\xi_0),(\psi_h,\eta_h)) - \A_h((\zeta_{0,h},\xi_{0,h}),(\psi_h,\eta_h)) = \gamma^{-1/2} (\bs{f}, \curl{(\psi_h - \Pi^1_{k,h} \psi_h)})
\end{align}

Furthermore, testing \eqref{eq:P.zeta0.xi0} with $(\zeta_0, \xi_0)$ and Young's inequality gives

\begin{align}
    \seminorm{H^1(\Omega)}{\zeta_0}^2 + (\zeta_0,1)^2 + \seminorm{H^1(\Omega)}{\xi_0}^2 &\lesssim \norm{L^2(\Omega)}{\bs{f}}^2, \nonumber\\
    \norm{H^1(\Omega)}{\zeta_0}^2 + \seminorm{H^1(\Omega)}{\xi_0}^2 &\lesssim \norm{L^2(\Omega)}{\bs{f}}^2. \label{eq:data.zeta0.xi0}
\end{align}
where in the last inequality is a consequence of Poincar\'e-Wirtinger inequality. Similarly, testing \eqref{eq:Ph.zeta0.xi0} with $(\zeta_{0,h}, \xi_{0,h})$, and in view of Assumption \ref{assum:coercivity} and stability of $\Pi^1_{k,h}$, we obtain
\begin{align}\label{eq:data.zeta0h.xi0h}
    \norm{H^1(\Omega)}{\zeta_{0,h}}^2 + \seminorm{H^1(\Omega)}{\xi_{0,h}}^2 \lesssim \norm{L^2(\Omega)}{\bs{f}}.
\end{align} 
% Furthermore, testing \eqref{eq:P.zeta0.xi0} with $(\zeta_0, \xi_0)$ and \eqref{eq:Ph.zeta0.xi0} with $(\zeta_{0,h}, \xi_{0,h})$, and in view of $\zeta_0, \zeta_{0,h} \in L_0^2(\Omega)$, Assumption \ref{assum:coercivity} and Young's inequality, we can obtain

% \begin{align}\label{eq:data.zeta0.xi0}
%     \seminorm{H^1(\Omega)}{\zeta_0}^2 + \seminorm{H^1(\Omega)}{\xi_0}^2 \lesssim \norm{L^2(\Omega)}{\bs{f}}^2, \quad \mbox{and} \quad
%     \seminorm{H^1(\Omega)}{\zeta_{0,h}}^2 + \seminorm{H^1(\Omega)}{\xi_{0,h}}^2 \lesssim \norm{L^2(\Omega)}{\bs{f}}.
% \end{align}

We estimate the error for $\xi_{0,h}$ in $H^1(\Omega)'$ by using a duality argument. To this end, consider the following dual problem. Given $\chi \in H^1(\Omega)$, let $(\lambda, \mu) \in H^1(\Omega) \times H_0^1(\Omega)$ solve
\begin{align}\label{eq:DP.coupled}
    \A((\psi,\eta),(\lambda,\mu)) + (\psi,1)(\lambda,1) = (\psi,\chi) \quad \forall (\psi,\eta) \in H^1(\Omega) \times H_0^1(\Omega).
\end{align} 
Observe that testing the above well-posed dual problem with $(\lambda, \mu)$ gives the following stability estimate,
\begin{align}\label{eq:DP.stab.est}
    \norm{H^1(\Omega)}{\lambda}^2 + \norm{H^1(\Omega)}{\mu}^2 \lesssim \norm{L^2(\Omega)}{\chi}^2.
\end{align}
Using the definition of $\A(\cdot,\cdot)$, we can rewrite \eqref{eq:DP.coupled} as the following coupled system:
\begin{align}
    (\curl{\psi}, \curl{\lambda}) + (\psi,1)(\lambda,1) &= (\psi,\chi) + \gamma^{1/2}(\psi,\mu) \quad \forall \psi \in H^1(\Omega), \           \label{eq:DP.coupled.1}\\
    (\curl{\eta}, \curl{\mu}) + \beta(\eta, \mu) &= -\gamma^{1/2}(\lambda,\eta) \quad \forall \eta \in H_0^1(\Omega). \label{eq:DP.coupled.2}
\end{align}
Thus, using Lemma \ref{lem:reg.pure-neumann} on \eqref{eq:DP.coupled.1}, and Lemma \ref{lem:reg.reac-diff} on \eqref{eq:DP.coupled.2}, followed by the stability estimate \eqref{eq:DP.stab.est}, we have the following regularity result for the dual problem,
\begin{align}\label{eq:DP.regularity}
    \norm{H^{1+(\pi/\omega)-\epsilon}(\Omega)}{\lambda} + \norm{H^{1+(\pi/\omega)-\epsilon}(\Omega)}{\mu} \lesssim \norm{H^1(\Omega)}{\chi}.
\end{align}

Testing \eqref{eq:DP.coupled} with $(\psi, \eta) = (\zeta_0 - \zeta_{0,h}, \xi_0 - \xi_{0,h}) \in H^1(\Omega) \times H_0^1(\Omega)$ and using the fact that $\xi_0, \xi_{0,h} \in L_0^2(\Omega)$, we have
\begin{align}
    (\xi_0 - \xi_{0,h}, \chi)  &= \A((\zeta_0 - \zeta_{0,h}, \xi_0 - \xi_{0,h}),(\lambda,\mu)) \nonumber\\
    &=  \A((\zeta_0 - \zeta_{0,h}, \xi_0 - \xi_{0,h}),(\lambda - \Ih{\lambda},\mu - \Ih{\mu})) + \A((\zeta_0 - \zeta_{0,h}, \xi_0 - \xi_{0,h}),(\Ih{\lambda},\Ih{\mu})). \label{eq:err.coupled.xi0.1}
\end{align}

The first term in \eqref{eq:err.coupled.xi0.1} is bounded using the definition of $\A$, Cauchy-Schwarz inequality, \eqref{eq:data.zeta0.xi0}, and \eqref{eq:data.zeta0h.xi0h} to get
\begin{align}\label{eq:err.coupled.xi0.1.a}
    &\A((\zeta_0 - \zeta_{0,h}, \xi_0 - \xi_{0,h}),(\lambda - \Ih{\lambda},\mu - \Ih{\mu})) \nonumber\\
    &\lesssim \left(\norm{H^1(\Omega)}{\zeta_0 - \zeta_{0,h}} + 
    \seminorm{H^1(\Omega)}{\xi_0 - \xi_{0,h}}\right)
     \times \left( \norm{H^1(\Omega)}{\lambda - \Ih{\lambda}} + \seminorm{H^1(\Omega)}{\mu - \Ih{\mu}} \right) \nonumber\\
    &\lesssim  \left( \norm{H^1(\Omega)}{\lambda - \Ih{\lambda}} + \seminorm{H^1(\Omega)}{\mu - \Ih{\mu}} \right) \norm{L^2(\Omega)}{\bs{f}}.
\end{align}

The second term in \eqref{eq:err.coupled.xi0.1} is bounded using the error equation \eqref{eq:erreq.rho} for $(\psi_h,\eta_h) = (\Ih{\lambda}, \Ih{\mu})$ as follows:
\begin{align}\label{eq:err.coupled.xi0.1.b}
    &\A((\zeta_0 - \zeta_{0,h}, \xi_0 - \xi_{0,h}),(\Ih{\lambda},\Ih{\mu})) \nonumber\\
    &= \gamma^{-1/2} (\bs{f}, \curl{(\Ih{\lambda} - \Pi^1_{k,h} \Ih{\lambda})}) + \A_h((\zeta_{0,h},\xi_{0,h}),(\Ih{\lambda},\Ih{\mu})) - \A((\zeta_{0,h},\xi_{0,h}),(\Ih{\lambda},\Ih{\mu})) \nonumber\\
    &\lesssim \norm{L^2(\Omega)}{\bs{f}} \seminorm{1,h}{(I-\Pi^1_{k,h})\Ih{\lambda}} + \A_h((\zeta_{0,h},\xi_{0,h}),(\Ih{\lambda},\Ih{\mu})) - \A((\zeta_{0,h},\xi_{0,h}),(\Ih{\lambda},\Ih{\mu})).
\end{align}
The difference in \eqref{eq:err.coupled.xi0.1.b} can be rewritten as follows:
\begin{align*}
    &\A_h((\zeta_{0,h},\xi_{0,h}),(\Ih{\lambda},\Ih{\mu})) - \A((\zeta_{0,h},\xi_{0,h}),(\Ih{\lambda},\Ih{\mu})) \nonumber\\
    &\quad= \left(a_h(\zeta_{0,h}, \Ih{\lambda}) - (\curl{\zeta_{0,h}}, \curl{\Ih{\lambda}})\right) 
    + \left(a_h(\xi_{0,h}, \Ih{\mu}) - (\curl{\xi_{0,h}}, \curl{\Ih{\mu}})\right) \\
    &\qquad +\left(\gamma^{1/2} (\Pi^0_{k,h} \Ih{\lambda}, \Pi^0_{k,h}\xi_{0,h}) - \gamma^{1/2}(\Ih{\lambda}, \xi_{0,h})\right) + \left(\gamma^{1/2} (\xi_{0,h}, \Ih{\mu})-\gamma^{1/2}(\Pi^0_{k,h} \zeta_{0,h}, \Pi^0_{k,h} \Ih{\mu})\right) \\
    &\qquad  +\left(\beta(\Pi^0_{k,h}\xi_{0,h}, \Pi^0_{k,h}\Ih{\mu}) - \beta(\xi_{0,h}, \Ih{\mu})\right) \\
    &\quad =: T_1 + T_2 + T_3 + T_4 + T_5.
\end{align*}





